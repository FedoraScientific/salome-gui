#  Copyright (C) 2003  CEA/DEN, EDF R&D
#
#
#
#  File   : Makefile.in
#  Author : Nicolas REJNERI
#  Module : SALOME
#  $Header$

top_srcdir=@top_srcdir@
top_builddir=../../..
srcdir=@srcdir@
VPATH=.:@srcdir@:@top_srcdir@/idl

@COMMENCE@

# small trick for Mandrake-10.1: PyQt 3.13 does not support Qt 3.3.3
ifeq ($(QT_VERS),Qt_3_3_3)
QT_VERS = Qt_3_3_0
endif

ifeq ($(QT_VERS),Qt_3_3_4)
QT_VERS = Qt_3_3_0
endif

# Sip flags
SIP_FLAGS = -t WS_X11 -t $(QT_VERS) $(PYQT_SIPFLAGS) -s ".cc" -c . -I $(PYQT_SIPS)

# Sip sources
ifeq ($(SIP_VERS),v4_old)
SIP_SRC   = sipSalomePyQtGUIcmodule.cc
SIP_FILES = SALOME_PYQT_GUI.sip
else
ifeq ($(SIP_VERS),v4_new)
SIP_SRC   = sipSalomePyQtGUIcmodule.cc
SIP_FILES = SALOME_PYQT_GUI.sip
else
SIP_SRC   = SalomePyQtGUIcmodule.cc
SIP_FILES = SALOME_PYQT_GUI.sip
endif
endif

######################

# headers
EXPORT_HEADERS = SALOME_PYQT_GUI.h \
                 SALOME_PYQT_PyInterp.h \
                 SALOME_PYQT_Module.h

# Library target
LIB = libSalomePyQtGUI.la

# library sources
LIB_SRC = SALOME_PYQT_PyInterp.cxx \
          SALOME_PYQT_Module.cxx \
         $(SIP_SRC)

# moc pre-processing
LIB_MOC = SALOME_PYQT_Module.h

LIB_CLIENT_IDL = SALOME_Exception.idl \
                 SALOME_GenericObj.idl \
                 SALOME_ContainerManager.idl \
                 SALOME_Component.idl 

CPPFLAGS += $(QT_INCLUDES) $(SIP_INCLUDES) $(PYTHON_INCLUDES) $(OCC_INCLUDES) $(VTK_INCLUDES) $(OGL_INCLUDES) $(BOOST_CPPFLAGS) -DHAVE_CONFIG_H -I${KERNEL_ROOT_DIR}/include/salome -D__CALL_OLD_METHODS__

LIBS     += $(PYTHON_LIBS) $(SIP_LIBS) $(PYQT_LIBS) $(VTK_LIBS) $(OGL_LIBS)
LDFLAGS  += -lPyInterp -lSalomeApp

##################################

# Custom build step: generate C++ wrapping according to $(SIP_FILES)

$(SIP_SRC): $(SIP_FILES)
	$(SIP) $(SIP_FLAGS) $<

$(MOC_SRC): $(MOC_H)
	$(MOC) $< -o $@

###################################

@CONCLUDE@
