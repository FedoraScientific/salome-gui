<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><HTML>
<HEAD>
<!-- hennerik CVSweb $Revision$ -->
<TITLE>Example</TITLE></HEAD>
<BODY BGCOLOR="#eeeeee">
<HR noshade><PRE>Methods : GetAvailableUndos, ChangeValue, FindOrCreateAttribute, SaveAs, GetAvailableRedos, Undo, FindComponent, Redo, FindAttribute, Open, CommitCommand, NewCommand


dir= os.getenv(&quot;TmpDir&quot;)
if dir == None:
 &nbsp; &nbsp; &nbsp; &nbsp;dir = &quot;/tmp&quot;

batchmode_geompy.myBuilder._set_UndoLimit(20)

# 1st transaction -----------------------------------------
batchmode_geompy.myBuilder.NewCommand()
# &nbsp; &nbsp; &nbsp; create AttributeSequenceOfInteger &nbsp; &nbsp; &nbsp;
#=========================================================
A = batchmode_geompy.myBuilder.FindOrCreateAttribute(batchmode_geompy.father, &quot;AttributeSequenceOfInteger&quot;)
if A == None :
 &nbsp; &nbsp; &nbsp; &nbsp;raise &nbsp;RuntimeError, &quot;Can't create AttributeSequenceOfInteger attribute&quot;
A = A._narrow(SALOMEDS.AttributeSequenceOfInteger)
if A == None :
 &nbsp; &nbsp; &nbsp; &nbsp;raise &nbsp;RuntimeError, &quot;Can't create AttributeSequenceOfInteger attribute&quot;

A.Add(100)
A.Add(300)
A.Add(500)
A.Add(400)
A.Add(700)
print &quot;First transaction goes on : &nbsp;HasOpenCommand() = &quot;, batchmode_geompy.myBuilder.HasOpenCommand()
batchmode_geompy.myBuilder.CommitCommand() #--------------

# 2nd transaction ------------------------------------------
batchmode_geompy.myBuilder.NewCommand() 
A.Remove(3)
A.ChangeValue(4,500)
batchmode_geompy.myBuilder.CommitCommand() #--------------

if batchmode_geompy.myBuilder.GetAvailableUndos() == 0:
 &nbsp; &nbsp; &nbsp; &nbsp;raise RuntimeError, &quot;GetAvailableUndos() = 0 but must not !&quot;

if A.Length() != 4:
 &nbsp; &nbsp; &nbsp; &nbsp;print &quot;Wrong length of SequenceOfInteger&quot;
if A.Value(1) != 100 or A.Value(2) != 300 or A.Value(3) != 400 or A.Value(4) != 500:
 &nbsp; &nbsp; &nbsp; &nbsp;raise &nbsp;RuntimeError, &quot;Wrong &nbsp;value of &nbsp;AttributeSequenceOfInteger&quot;

file1 = dir + &quot;/test1.hdf&quot;
batchmode_geompy.myStudyManager.SaveAs(file1, batchmode_geompy.myStudy)

# 1st Undo ---------------------------------------
batchmode_geompy.myBuilder.Undo()
res, A = batchmode_geompy.myBuilder.FindAttribute(batchmode_geompy.father, &quot;AttributeSequenceOfInteger&quot;)
if A is None:
 &nbsp; &nbsp; &nbsp; &nbsp;raise &nbsp;RuntimeError, &quot;After first 'undo' can't find AttributeSequenceOfInteger&quot;
if A.Length() != 5:
 &nbsp; &nbsp; &nbsp; &nbsp;print &quot;Wrong length of SequenceOfInteger&quot;
if A.Value(1) != 100 or A.Value(2) != 300 or A.Value(3) != 500 or A.Value(4) != 400 or &nbsp;A.Value(5) != 700:
 &nbsp; &nbsp; &nbsp; &nbsp;print &nbsp;A.Value(1), A.Value(2), A.Value(3), A.Value(4), A.Value(5)
 &nbsp; &nbsp; &nbsp; &nbsp;raise &nbsp;RuntimeError, &quot;Wrong &nbsp;value of &nbsp;AttributeSequenceOfInteger after the first 'undo'!&quot;
# save 
file2 = dir + &quot;/test2.hdf&quot;
batchmode_geompy.myStudyManager.SaveAs(file2, batchmode_geompy.myStudy)
#-------------------------------------------------
# 2nd Undo ---------------------------------------
batchmode_geompy.myBuilder.Undo()
res, attr = batchmode_geompy.myBuilder.FindAttribute(batchmode_geompy.father, &quot;AttributeSequenceOfInteger&quot;)
if res !=0 or attr != None :
 &nbsp; &nbsp; &nbsp; &nbsp;raise &nbsp;RuntimeError, &quot;After the second 'undo' AttributeSequenceOfInteger exists but must not!&quot;
file3 = dir + &quot;/test3.hdf&quot;
batchmode_geompy.myStudyManager.SaveAs(file3, batchmode_geompy.myStudy)
#-------------------------------------------------

#make redo twice ---------------------------------
if batchmode_geompy.myBuilder.GetAvailableRedos() == 0:
 &nbsp; &nbsp; &nbsp; &nbsp;raise RuntimeError, &quot;GetAvailableRedos() = 0 but must not !&quot;
batchmode_geompy.myBuilder.Redo()
batchmode_geompy.myBuilder.Redo()
res, A = batchmode_geompy.myBuilder.FindAttribute(batchmode_geompy.father, &quot;AttributeSequenceOfInteger&quot;)
if res ==0 or A== None :
 &nbsp; &nbsp; &nbsp; &nbsp;raise &nbsp;RuntimeError, &quot;AttributeSequenceOfInteger is not found but must be!&quot;
if A.Length() != 4:
 &nbsp; &nbsp; &nbsp; &nbsp;print &quot;Wrong length of SequenceOfInteger&quot;
if A.Value(1) != 100 or A.Value(2) != 300 or A.Value(3) != 400 or A.Value(4) != 500:
 &nbsp; &nbsp; &nbsp; &nbsp;raise &nbsp;RuntimeError, &quot;Wrong &nbsp;value of &nbsp;AttributeSequenceOfInteger&quot;


#----------------------------------------------------------------------
openedStudy=batchmode_geompy.myStudyManager.Open(file1);

if openedStudy == None:
 &nbsp; &nbsp; &nbsp; &nbsp;raise &nbsp;RuntimeError, &quot;Can't open saved study!&quot;


father = openedStudy.FindComponent(&quot;GEOM&quot;)
if father is None:
 &nbsp; &nbsp; &nbsp; &nbsp; raise &nbsp;RuntimeError, &quot;Geom component is not found! &nbsp;Wrong study is opened.&quot; 


# &nbsp; &nbsp; find AttributeSequenceOfInteger
#======================================

res,A=father.FindAttribute(&quot;AttributeSequenceOfInteger&quot;)
if res == 0 or A == None:
 &nbsp; &nbsp; &nbsp; &nbsp;raise &nbsp;RuntimeError, &quot;Error: &nbsp;not found AttributeSequenceOfInteger&quot;

A = A._narrow(SALOMEDS.AttributeSequenceOfInteger)

if A.Length() != 4:
 &nbsp; &nbsp; &nbsp; &nbsp;print &quot;Wrong length of SequenceOfInteger&quot;
if A.Value(1) != 100 or A.Value(2) != 300 or A.Value(3) != 400 or A.Value(4) != 500:
 &nbsp; &nbsp; &nbsp; &nbsp;print &quot;Wrong &nbsp;value of &nbsp;AttributeSequenceOfInteger&quot;
#----------------------------------------------------------------------
openedStudy=batchmode_geompy.myStudyManager.Open(file2);

if openedStudy == None:
 &nbsp; &nbsp; &nbsp; &nbsp;raise &nbsp;RuntimeError, &quot;Can't open saved study!&quot;


father = openedStudy.FindComponent(&quot;GEOM&quot;)
if father is None:
 &nbsp; &nbsp; &nbsp; &nbsp; raise &nbsp;RuntimeError, &quot;Geom component is not found! &nbsp;Wrong study is opened.&quot; 


# &nbsp; &nbsp; find AttributeSequenceOfInteger
#======================================

res,A=father.FindAttribute(&quot;AttributeSequenceOfInteger&quot;)
if res == 0 or A == None:
 &nbsp; &nbsp; &nbsp; &nbsp;raise &nbsp;RuntimeError, &quot;Error: &nbsp;not found AttributeSequenceOfInteger&quot;

A = A._narrow(SALOMEDS.AttributeSequenceOfInteger)

if A.Length() != 5:
 &nbsp; &nbsp; &nbsp; &nbsp;print &quot;Wrong length of SequenceOfInteger&quot;
if A.Value(1) != 100 or A.Value(2) != 300 or A.Value(3) != 500 or A.Value(4) != 400 or &nbsp;A.Value(5) != 700:
 &nbsp; &nbsp; &nbsp; &nbsp;raise &nbsp;RuntimeError, &quot;Wrong &nbsp;value of &nbsp;AttributeSequenceOfInteger after the first 'undo'!&quot;

#----------------------------------------------------------------------
openedStudy=batchmode_geompy.myStudyManager.Open(file3);

if openedStudy == None:
 &nbsp; &nbsp; &nbsp; &nbsp;raise &nbsp;RuntimeError, &quot;Can't open saved study!&quot;


father = openedStudy.FindComponent(&quot;GEOM&quot;)
if father is None:
 &nbsp; &nbsp; &nbsp; &nbsp; raise &nbsp;RuntimeError, &quot;Geom component is not found! &nbsp;Wrong study is opened.&quot; 


# &nbsp; &nbsp; find AttributeSequenceOfInteger
#======================================

res,A=father.FindAttribute(&quot;AttributeSequenceOfInteger&quot;)

if res!=0 or A != None:
 &nbsp; &nbsp; &nbsp; &nbsp;raise RuntimeError, &quot; AttributeSequenceOfInteger is found but must not!&quot;
</PRE>