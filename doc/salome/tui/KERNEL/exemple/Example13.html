<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><HTML>
<HEAD>
<!-- hennerik CVSweb $Revision$ -->
<TITLE>Example</TITLE></HEAD>
<BODY BGCOLOR="#eeeeee">
<HR noshade><PRE>#%Test AttributeTextHighlightColor interface(creations/saving/restoring)%
#%SALOMEDS methods : FindOrCreateAttribute, SaveAs, FindComponent, FindAttribute, Open%
#%Attribute methods : &nbsp;SetTextHighlightColor TextHighlightColor%

#--------------------------------------------------------------------------
# &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;create &nbsp; &nbsp;AttributeTextHighlightColor
#===========================================================

import SALOMEDS_Attributes_idl
highlightcolor=SALOMEDS_Attributes_idl._0_SALOMEDS.Color(256,256,256)

A = batchmode_geompy.myBuilder.FindOrCreateAttribute(batchmode_geompy.father, &quot;AttributeTextHighlightColor&quot;)

if A == None :
 &nbsp; &nbsp; &nbsp; &nbsp;raise &nbsp;RuntimeError, &quot;Can't create AttributeTextHighlightColor attribute&quot;
A = A._narrow(SALOMEDS.AttributeTextHighlightColor)

if A == None :
 &nbsp; &nbsp; &nbsp; &nbsp;raise &nbsp;RuntimeError, &quot;Can't create AttributeTextHighlightColor attribute&quot;

A.SetTextHighlightColor(highlightcolor)

c = A.TextHighlightColor();
if c.R != 256 or c.G != 256 or c.B != 256:
 &nbsp; &nbsp; &nbsp; &nbsp;print &quot;Error: wrong value of AttributeTextHighlightColor&quot;


# &nbsp; &nbsp; &nbsp;save / restore study &nbsp; &nbsp; &nbsp;
#============================================================
str= os.getenv(&quot;TmpDir&quot;)
if str == None:
 &nbsp; &nbsp; &nbsp; &nbsp;str = &quot;/tmp&quot;
file = str+&quot;/test.hdf&quot;

batchmode_geompy.myStudyManager.SaveAs(file, batchmode_geompy.myStudy)
openedStudy=batchmode_geompy.myStudyManager.Open(file);

if openedStudy == None:
 &nbsp; &nbsp; &nbsp; &nbsp;raise &nbsp;RuntimeError, &quot;Can't open saved study!&quot;

father = openedStudy.FindComponent(&quot;GEOM&quot;)
if father is None:
 &nbsp; &nbsp; &nbsp; &nbsp; raise &nbsp;RuntimeError, &quot;Geom component is not found! &nbsp;Wrong study is opened.&quot; 


# &nbsp; &nbsp; &nbsp; find &nbsp; AttributeTextHighlightColor
#============================================================

res, A = father.FindAttribute(&quot;AttributeTextHighlightColor&quot;)
print res, A
if res == 0 or A == None:
 &nbsp; &nbsp; &nbsp; &nbsp;raise &nbsp;RuntimeError, &quot;Error: &nbsp;not found AttributeTextHighlightColor&quot;

A = A._narrow(SALOMEDS.AttributeTextHighlightColor)

if A == None :
 &nbsp; &nbsp; &nbsp; &nbsp;raise &nbsp;RuntimeError, &quot;Can't create AttributeTextHighlightColor attribute&quot;

c = A.TextHighlightColor();

if c.R != 256 or c.G != 256 or c.B != 256:
 &nbsp; &nbsp; &nbsp; &nbsp;print &quot;Error: wrong value of AttributeTextTextHighlightColor&quot;
</PRE>