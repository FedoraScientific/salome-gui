<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><HTML>
<HEAD>
<!-- hennerik CVSweb $Revision$ -->
<TITLE>Exemple</TITLE></HEAD>
<BODY BGCOLOR="#eeeeee">
<HR noshade><PRE>
#^SALOMEDS methods : FindOrCreateAttribute, SaveAs, FindComponent, FindAttribute, Open^
#^Attribute methods: GetValue, GetNbColumns, AddColumn, SetRowTitles, PutValue, GetColumn, GetColumnTitles, GetTitle, SetRow, GetRowTitles, SetColumnTitles, SetColumn, GetRow, GetNbRows, SetColumnTitle, AddRow, SetTitle, SetRowTitle^

# &nbsp; &nbsp; &nbsp; create AttributeReal &nbsp; &nbsp; &nbsp;
#=======================================================================================================
A = batchmode_geompy.myBuilder.FindOrCreateAttribute(batchmode_geompy.father, &quot;AttributeTableOfInteger&quot;)
if A == None :
 &nbsp; &nbsp; &nbsp; &nbsp;raise &nbsp;RuntimeError, &quot;Can't create AttributeTableOfInteger attribute&quot;
A = A._narrow(SALOMEDS.AttributeTableOfInteger)
a=[1,2]

b=[3,4]

# &nbsp; &nbsp;2x2
# --- rows ---
A.AddRow(a)
A.AddRow(b)
a=[34,14]
A.SetRow(1,a)

# &nbsp; &nbsp;3x3
#
b=[54,56]
A.AddRow(b)

# --- columns ---
a=[76,25,12]

A.AddColumn(a)
a=[836,3425,342]
A.SetColumn(3,a)

# change attribute values
print &quot;A.GetValue(2,2) = &quot;, A.GetValue(2,2)
print &quot;A.PutValue(2,2,625323)&quot;
A.PutValue(625323,2,2)
print &quot;A.GetValue(2,2) = &quot;, A.GetValue(2,2)

#set Titles

A.SetTitle(&quot;TEST&quot;)

A.SetRowTitle(1,&quot;FR&quot;)
A.SetRowTitle(2,&quot;SR&quot;)
A.SetRowTitle(3,&quot;TR&quot;)

A.SetColumnTitle(1,&quot;FC&quot;)
A.SetColumnTitle(2,&quot;SC&quot;)
A.SetColumnTitle(3,&quot;TC&quot;)


#check the table
print &quot;Common title : &quot;,A.GetTitle()
print &quot;Rows titles : &quot;, &nbsp;A.GetRowTitles()
rnb = A.GetNbRows()
for i in range(1, rnb):
 &nbsp; &nbsp; &nbsp; &nbsp;b=A.GetRow(i)
 &nbsp; &nbsp; &nbsp; &nbsp;print b

cnb = A.GetNbColumns()
print &quot;Columns title : &quot;, A.GetColumnTitles()
for i in range(1, cnb):
 &nbsp; &nbsp; &nbsp; &nbsp;b=A.GetColumn(i)
 &nbsp; &nbsp; &nbsp; &nbsp;print b

# set titles
#titles=[&quot;11&quot;,&quot;12&quot;,&quot;13&quot;]
#A.SetRowTitles(titles)
#titles=[&quot;21&quot;,&quot;22&quot;,&quot;23&quot;]
#A.SetRowTitles(2,titles)
#titles=[&quot;31&quot;,&quot;32&quot;,&quot;33&quot;]
#A.SetRowTitles(3,titles)

#--------------------------------------------------------------------------#
# ----------------------- save the study ----------------------------------#
#--------------------------------------------------------------------------#
str= os.getenv(&quot;TmpDir&quot;)
if str == None:
 &nbsp; &nbsp; &nbsp; &nbsp;str = &quot;/tmp&quot;
file = str+&quot;/test.hdf&quot;

print &quot; ------- &nbsp;We will save to&quot;, file, &quot;-----------&quot;

batchmode_geompy.myStudyManager.SaveAs(file, batchmode_geompy.myStudy)

#--------------------------------------------------------------------------#
#---------------------------- Open file -----------------------------------# 
#--------------------------------------------------------------------------#

print&quot; -------------- Open &nbsp;&quot; + file + &quot;-------------- &quot; 

openedStudy=batchmode_geompy.myStudyManager.Open(file)
if openedStudy == None:
 &nbsp; &nbsp; &nbsp; &nbsp;raise &nbsp;RuntimeError, &quot;Can't open saved study!&quot;

father = openedStudy.FindComponent(&quot;GEOM&quot;)
if father is None:
 &nbsp; &nbsp; &nbsp; &nbsp; raise &nbsp;RuntimeError, &quot;Geom component is not found! &nbsp;Wrong study is opened.&quot; 

# --- check attribute ---

res,A=father.FindAttribute(&quot;AttributeTableOfInteger&quot;)
if res == 0 or A == None:
 &nbsp; &nbsp; &nbsp; &nbsp;raise &nbsp;RuntimeError, &quot;Error: &nbsp;not found AttributeTableOfInteger&quot;

A = A._narrow(SALOMEDS.AttributeTableOfInteger)

#check the table
print &quot;Common title : &quot;,A.GetTitle()
print &quot;Rows titles : &quot;, &nbsp;A.GetRowTitles()
rnb = A.GetNbRows()
for i in range(1, rnb):
 &nbsp; &nbsp; &nbsp; &nbsp;b=A.GetRow(i)
 &nbsp; &nbsp; &nbsp; &nbsp;print b

cnb = A.GetNbColumns()
print &quot;Columns title : &quot;, A.GetColumnTitles()
for i in range(1, cnb):
 &nbsp; &nbsp; &nbsp; &nbsp;b=A.GetColumn(i)
 &nbsp; &nbsp; &nbsp; &nbsp;print b

titles=[&quot;ff&quot;,&quot;ss&quot;,&quot;tt&quot;]
A.SetRowTitles(titles)
print &quot;Rows titles : &quot;, &nbsp;A.GetRowTitles()

titles=[&quot;ww&quot;,&quot;zz&quot;,&quot;cc&quot;]
A.SetColumnTitles(titles)
print &quot;Column titles : &quot;, &nbsp;A.GetColumnTitles()

</PRE>